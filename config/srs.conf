# SRS Configuration File
# See https://ossrs.io/lts/en-us/docs/v6/category/main-protocols for more information about config options.


# Global Server Configuration
listen              1935                              # RTMP Listen Port
max_connections     1000                              # Max number of RTMP connections per server
pid_file            /usr/local/srs/srs.pid            # PID file path

# HTTP API and Stream Statistics
http_api {
    enabled          on                               # Enable SRS HTTP API
    listen           1985                             # HTTP API port
    crossdomain      on                               # Enable crossdomain.xml
}

# HTTP Publish
http_static {
    enabled          on                               # Enable static file delivery (HLS, etc.)
    dir              /usr/local/srs/objs/nginx/html   # Path for static files like HLS
}

# HLS Configuration
hls {
    enabled          on                               # Enable HLS (HTTP Live Streaming)
    hls_path         ./objs/nginx/html                # HLS output directory
    hls_time         10                               # HLS segment duration in seconds
    hls_list_size    10                               # Number of segments in HLS playlist
    hls_window_size  5                                # Sliding window size
}

# WebRTC Configuration
webrtc {
    enabled          on                               # Enable WebRTC
    listen           10080                            # WebRTC Media Transport Port (UDP)
}

# RTMP Configuration (Main RTMP Streaming)
vhost __defaultVhost__ {
    # Basic RTMP settings
    listen           1935                             # RTMP Listen Port
    chunk_size       4096                             # Chunk size for RTMP packets
    gop_cache        on                               # Enable GOP caching
    ping             30                               # Connection ping interval
    ping_timeout     30                               # Timeout for connection

    # RTMP Applications
    app live {
        # Basic Live Application Settings
        live            on                            # Enable live streaming
        hls             on                            # Enable HLS for live streams
        hls_path        ./objs/nginx/html             # HLS directory
        hls_time        10                            # HLS segment duration
        hls_list_size   10                            # Number of HLS segments to keep
        hls_window_size 5                             # Sliding window for HLS
    }

    app test {
        # Test application
        live            on
        # Can add more custom settings as needed
    }

    # HTTP Callback Hooks
    http_hooks {
        enabled         on
        on_publish      http://api:8080/api/rtmp/auth
        on_unpublish    http://api:8080/api/rtmp/publish-done
        on_play         http://api:8080/api/rtmp/auth
    }
}

# RTMP Push Configuration (Optional)
push rtmp://another_server/stream_key {
    enabled          on
    # Configurations for pushing RTMP to another server
    # Example: push to another server or service (e.g., for simulcasting)
}

# Log Configuration (optional)
log {
    # Log configurations (for debugging purposes)
    level            trace               # Log level (debug, info, trace)
    file             ./objs/logs/srs.log # Log file path
}

# RTMP/RTSP/HTTP Callback URL for external notifications)
callback {
    enabled          off                # Turn off or on callback URL for external systems
    # Additional callback configurations
}

# Additional Security Settings (optional)
security {
    rtmp_auth {
        enabled          off              # Turn on/off RTMP authentication
        # Configure RTMP authentication (e.g., password protection)
    }
}


# Log settings
srs_log_tank        file
srs_log_file        /usr/local/srs/logs/srs.log
srs_log_level       trace